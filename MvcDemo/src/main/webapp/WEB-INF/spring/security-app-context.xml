<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
                    http://www.springframework.org/schema/beans/spring-beans.xsd
                    http://www.springframework.org/schema/security 
                    http://www.springframework.org/schema/security/spring-security.xsd">

	<http use-expressions="true">
		<intercept-url pattern="/home" access="permitAll" />
		<intercept-url pattern="/open" access="permitAll" />
		<intercept-url pattern="/secured/customer/**" access="hasRole('customer')" />
		<intercept-url pattern="/secured/support/**" access="hasRole('support')" />
		<intercept-url pattern="/secured/admin/**" access="hasRole('admin')" />
		<intercept-url pattern="/secured/**" access="isAuthenticated()" />
		<!-- <intercept-url pattern="/**" access="denyAll" /> -->
		
		<!-- <intercept-url pattern="/secured/extreme/**" access="hasRole('admin')" />
		<intercept-url pattern="/listAccounts.html" access="isAuthenticated()" />
		<intercept-url pattern="/post.html"
			access="hasAnyRole('supervisor','teller')" />
		<intercept-url pattern="/**" access="denyAll" /> -->
		
		<form-login />
		<!-- <http-basic/> -->

				
		<logout logout-url="/j_spring_security_logout" logout-success-url="/" />
	</http>

	<authentication-manager>
		<authentication-provider>
            <password-encoder hash="md5" />
			<user-service>
                <!-- password: admin -->
				<user name="admin" password="21232f297a57a5a743894a0e4a801fc3" authorities="admin, customer, user" />
                <!-- password: password -->
                <user name="user" password="5f4dcc3b5aa765d61d8327deb882cf99" authorities="user" />
			</user-service>
		</authentication-provider>
	</authentication-manager>
</beans:beans>
